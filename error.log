  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:13<00:00, 13.55s/it]100%|██████████| 1/1 [00:13<00:00, 13.55s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:07<00:00,  7.50s/it]100%|██████████| 1/1 [00:07<00:00,  7.50s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:06<00:00,  6.87s/it]100%|██████████| 1/1 [00:06<00:00,  6.87s/it]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:03<?, ?it/s]
Traceback (most recent call last):
  File "/home/x/xuxilie/PromptAttack/robustness_eval.py", line 177, in <module>
    batch_adv_x = adv_generator.batch_attack(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/PromptAttack/PromptAttack.py", line 265, in batch_attack
    adv_samples, _, _ = self.batch_fidelity_filter(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/PromptAttack/PromptAttack.py", line 137, in batch_fidelity_filter
    _, _, BERTScores = score(ori_samples, adv_samples, lang="en")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/bert_score/score.py", line 98, in score
    model = get_model(model_type, num_layers, all_layers)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/bert_score/utils.py", line 255, in get_model
    model = AutoModel.from_pretrained(model_type)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/transformers/models/auto/auto_factory.py", line 493, in from_pretrained
    return model_class.from_pretrained(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2700, in from_pretrained
    model = cls(config, *model_args, **model_kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 713, in __init__
    self.encoder = RobertaEncoder(config)
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 477, in __init__
    self.layer = nn.ModuleList([RobertaLayer(config) for _ in range(config.num_hidden_layers)])
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 477, in <listcomp>
    self.layer = nn.ModuleList([RobertaLayer(config) for _ in range(config.num_hidden_layers)])
                                ^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 398, in __init__
    self.intermediate = RobertaIntermediate(config)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 358, in __init__
    self.dense = nn.Linear(config.hidden_size, config.intermediate_size)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 101, in __init__
    self.reset_parameters()
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 107, in reset_parameters
    init.kaiming_uniform_(self.weight, a=math.sqrt(5))
  File "/home/x/xuxilie/anaconda3/envs/adllm/lib/python3.11/site-packages/torch/nn/init.py", line 412, in kaiming_uniform_
    return tensor.uniform_(-bound, bound)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
